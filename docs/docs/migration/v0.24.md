---
sidebar_position: 0
title: v0.24
description: For chains that were scaffolded with Ignite CLI versions lower than v0.24, changes are required to use Ignite CLI v0.24. 
---

## Cosmos SDK v0.46 upgrade notes

### Module keeper

Add an import:

```go
// x/{{moduleName}}/keeper/keeper.go

import (
	//...
  storetypes "github.com/cosmos/cosmos-sdk/store/types"
)
```

In the `Keeper` struct replace `sdk.StoreKey` with `storetypes.StoreKey`:

```go
// x/{{moduleName}}/keeper/keeper.go

type (
	Keeper struct {
		cdc        codec.BinaryCodec
		storeKey   storetypes.StoreKey
		memKey     storetypes.StoreKey
		paramstore paramtypes.Subspace
	}
)
```

In the argument list of the `NewKeeper` function definition:

```go
// x/{{moduleName}}/keeper/keeper.go

func NewKeeper(
	//...
	memKey storetypes.StoreKey,
)
```

Store type aliases have been removed from the Cosmos SDK `types` package and now have to be imported from `store/types`, instead.

`/testutil/keeper/{{moduleName}}.go`

In the `{{moduleName}}Keeper` function replace `types.StoreKey` with `storetypes.StoreKey` and `types.MemStoreKey` with `storetypes.MemStoreKey`.

```go
// x/{{moduleName}}/keeper/keeper.go

func {{moduleName}}Keeper(t testing.TB) (*keeper.Keeper, sdk.Context) {
	storeKey := sdk.NewKVStoreKey(storetypes.StoreKey)
	memStoreKey := storetypes.NewMemoryStoreKey(storetypes.MemStoreKey)
  //...
}
```

### Testutil network package

Add the `require` package for testing and `pruningtypes` and remove `storetypes`:

```go
// testutil/network/network.go

import (
	pruningtypes "github.com/cosmos/cosmos-sdk/pruning/types"
	"github.com/stretchr/testify/require"
  // storetypes "github.com/cosmos/cosmos-sdk/store/types" <-- remove this line
)
```

In the `DefaultConfig` function replace `storetypes.NewPruningOptionsFromString` with `pruningtypes.NewPruningOptionsFromString`

```go
// testutil/network/network.go

func DefaultConfig() network.Config {
  //...
	return network.Config{
		AppConstructor: func(val network.Validator) servertypes.Application {
			return app.New(
				baseapp.SetPruning(pruningtypes.NewPruningOptionsFromString(val.AppConfig.Pruning)),
				//...
			)
		},
  //...
}
```

The `New` function in the Cosmos SDK `testutil/network` package now accepts [three arguments](https://github.com/cosmos/cosmos-sdk/blob/v0.46.0/testutil/network/network.go#L206) instead of two.

In the `New` function add `t.TempDir()` as the second argument to `network.New()` and test that no error is thrown with `require.NoError(t, err)`:

```go
// testutil/network/network.go

func New(t *testing.T, configs ...network.Config) *network.Network {
	//...
	net, err := network.New(t, t.TempDir(), cfg)
	require.NoError(t, err)
	//...
}
```

### Testutil keeper package

In the `{{moduleName}}Keeper` function make the following replacements:

- `storetypes.StoreKey` → `types.StoreKey`
- `storetypes.MemStoreKey` → `types.MemStoreKey`
- `sdk.StoreTypeIAVL` → `storetypes.StoreTypeIAVL`
- `sdk.StoreTypeMemory` → `storetypes.StoreTypeMemory`

```go
// testutil/keeper/{{moduleName}}.go

func {{moduleName}}Keeper(t testing.TB) (*keeper.Keeper, sdk.Context) {
	storeKey := sdk.NewKVStoreKey(types.StoreKey)
	memStoreKey := storetypes.NewMemoryStoreKey(types.MemStoreKey)
	//...
	stateStore.MountStoreWithDB(storeKey, storetypes.StoreTypeIAVL, db)
	stateStore.MountStoreWithDB(memStoreKey, storetypes.StoreTypeMemory, nil)
	//...
}
```

### IBC modules

If you have IBC-enabled modules (for example, added with `ignite scaffold module ... --ibc` or created manually), make the following changes to the source code.

`OnChanOpenInit` now returns to values: a `string` and an `error`:

```go
// x/{{moduleName}}/module_ibc.go

func (am AppModule) OnChanOpenInit(...) (string, error)
```

Ensure that all return statements (five, in the default template) in `OnChanOpenInit` return two values. For example:

```go
// x/{{moduleName}}/module_ibc.go

func (am AppModule) OnChanOpenInit(...) (string, error) {
	//...
	return "", sdkerrors.Wrapf(porttypes.ErrInvalidPort, "invalid port: %s, expected %s", portID, boundPort)
	//...
}
```

Error acknowledgments returned from Transfer `OnRecvPacket` now include a deterministic ABCI code and error message. Remove the `.Error()` call:

```go
// x/{{moduleName}}/module_ibc.go

func (am AppModule) OnRecvPacket(...) {
	//...
	if err := modulePacketData.Unmarshal(modulePacket.GetData()); err != nil {
		// return channeltypes.NewErrorAcknowledgement(sdkerrors.Wrapf(sdkerrors.ErrUnknownRequest, "cannot unmarshal packet data: %s", err.Error()).Error())
		return channeltypes.NewErrorAcknowledgement(sdkerrors.Wrapf(sdkerrors.ErrUnknownRequest, "cannot unmarshal packet data: %s", err.Error()))
	}
	//...
	default:
		// errMsg := fmt.Sprintf("unrecognized %s packet type: %T", types.ModuleName, packet)
		// return channeltypes.NewErrorAcknowledgement(errMsg)
		err := fmt.Errorf("unrecognized %s packet type: %T", types.ModuleName, packet)
		return channeltypes.NewErrorAcknowledgement(err)
}
```

### Main

The `Execute` function in Cosmos SDK `server/cmd` package now accepts [three arguments](https://github.com/cosmos/cosmos-sdk/blob/v0.46.0/server/cmd/execute.go#L20) instead of two.

```go
// cmd/{{projectName}}d/main.go

func main() {
	//...
	if err := svrcmd.Execute(rootCmd, "", app.DefaultNodeHome); err != nil {
		os.Exit(1)
	}
}

```